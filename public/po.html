<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buat Purchase Order Baru - Sinar Permata Agro</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/css/po.css">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#6a7b31">
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>
                <i class="fa-solid fa-plus-circle"></i> Buat Purchase Order
            </h1>
            <div class="header-actions">
                <a href="/daftarpo.html" class="btn btn-secondary"><i class="fa-solid fa-arrow-left"></i> Kembali</a>
            </div>
        </div>

        <form id="po-form" class="card">
            <div class="card-content">
                <!-- Section 1: Pilih Sumber Data -->
                <div class="detail-section">
                    <h3>1. Sumber Data</h3>
                    <div class="detail-grid">
                        <div class="form-group">
                            <label for="pr_id">Pilih PR (Fully Approved) <span class="required">*</span></label>
                            <select id="pr_id" name="pr_id" required onchange="loadPRDetails()">
                                <option value="">-- Pilih PR --</option>
                                <!-- Populate via JS -->
                            </select>
                            <small class="text-muted">Hanya PR dengan status Fully Approved yang muncul.</small>
                        </div>
                        <div class="form-group">
                            <label for="vendor_id">Pilih Vendor <span class="required">*</span></label>
                            <select id="vendor_id" name="vendor_id" required>
                                <option value="">-- Pilih Vendor --</option>
                                <!-- Populate via JS -->
                            </select>
                        </div>
                    </div>
                    <div class="detail-grid">
                        <div class="form-group">
                            <label for="tanggal">Tanggal PO</label>
                            <input type="date" id="tanggal" name="tanggal" required>
                        </div>
                    </div>
                </div>

                <!-- Section 2: Review PR Data -->
                <div id="pr-details-section" style="display: none;">
                    <div class="detail-section">
                        <h3>2. Detail Permintaan</h3>
                        <div class="detail-grid">
                            <div class="detail-row"><span class="label">Keperluan:</span><span class="value"
                                    id="pr_keperluan">-</span></div>
                            <div class="detail-row"><span class="label">Departemen:</span><span class="value"
                                    id="pr_departemen">-</span></div>
                            <div class="detail-row"><span class="label">Requester:</span><span class="value"
                                    id="pr_requester">-</span></div>
                        </div>
                    </div>

                    <!-- Section 3: Input Harga -->
                    <div class="detail-section">
                        <h3>3. Input Harga Item</h3>
                        <table class="items-table">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Material / Barang</th>
                                    <th>Qty</th>
                                    <th>Satuan</th>
                                    <th style="width: 25%">Harga Satuan (Rp)</th>
                                    <th style="width: 25%">Total (Rp)</th>
                                </tr>
                            </thead>
                            <tbody id="po-items-body">
                                <!-- Populate via JS -->
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="5" style="text-align: right"><strong>Subtotal:</strong></td>
                                    <td style="text-align: right"><strong id="summary-subtotal">Rp 0</strong></td>
                                </tr>
                                <tr>
                                    <td colspan="5" style="text-align: right">
                                        <label
                                            style="display: inline-flex; align-items: center; gap: 8px; cursor: pointer;">
                                            <input type="checkbox" id="include_ppn" onchange="calculateTotal()">
                                            Harga Termasuk PPN (11%)
                                        </label>
                                    </td>
                                    <td style="text-align: right"><strong id="summary-ppn">Rp 0</strong></td>
                                </tr>
                                <tr>
                                    <td colspan="5" style="text-align: right"><strong>Grand Total:</strong></td>
                                    <td style="text-align: right; color: var(--primary-color); font-size: 1.2em;">
                                        <strong id="summary-total">Rp 0</strong></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>

                    <div class="form-actions" style="margin-top: 24px; text-align: right;">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="fa-solid fa-save"></i> Simpan & Buat PO
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <script src="/js/po_form.js"></script>
</body>

</html>